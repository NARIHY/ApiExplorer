<div class="container my-4">

  <h2 class="title mb-4">API Explorer üîç</h2>

  <div class="row">
    <!-- LEFT -->
    <div class="col-md-8 mb-4 left">
      <!-- URL + M√©thode -->
      <div class="row g-3 mb-3">
        <div class="col-md-8">
          <mat-form-field class="field w-100" appearance="outline">
            <mat-label>URL</mat-label>
            <input matInput [(ngModel)]="url" placeholder="https://api.example.com/users">
          </mat-form-field>
        </div>
        <div class="col-md-4">
          <mat-form-field class="method-field w-100" appearance="outline">
            <mat-label>M√©thode</mat-label>
            <mat-select [(value)]="method" [ngClass]="method.toLowerCase()">
                <mat-option *ngFor="let m of methods" [value]="m">{{ m }}</mat-option>
            </mat-select>
            </mat-form-field>

        </div>
      </div>

      <!-- Authentication -->
      <mat-expansion-panel>
        <mat-expansion-panel-header>
          <mat-panel-title>üîê Authentification / Headers</mat-panel-title>
        </mat-expansion-panel-header>

        <div class="row g-3 auth-grid">
          <div class="col-md-6">
            <mat-form-field appearance="outline" class="w-100">
              <mat-label>Client ID</mat-label>
              <input matInput [(ngModel)]="clientId">
            </mat-form-field>
          </div>

          <div class="col-md-6">
            <mat-form-field appearance="outline" class="w-100">
              <mat-label>Client Secret</mat-label>
              <input matInput [(ngModel)]="clientSecret" type="password">
            </mat-form-field>
          </div>

          <div class="col-12">
            <mat-form-field appearance="outline" class="w-100">
              <mat-label>Bearer Token</mat-label>
              <input matInput [(ngModel)]="token" placeholder="eyJhbGciOi‚Ä¶">
            </mat-form-field>
          </div>

          <div class="col-12">
            <mat-form-field appearance="outline" class="w-100">
              <mat-label>Headers (JSON)</mat-label>
              <textarea matInput rows="4" [(ngModel)]="headers"></textarea>
            </mat-form-field>
          </div>
        </div>
      </mat-expansion-panel>

      <!-- Body -->
      <mat-form-field appearance="outline" class="w-100 mb-3">
        <mat-label>Body (JSON)</mat-label>
        <textarea matInput rows="6" [(ngModel)]="body"></textarea>
      </mat-form-field>
      <button mat-stroked-button color="accent" class="me-2" (click)="formatBody()">Formater JSON</button>

      <!-- Envoyer -->
      <button mat-raised-button color="primary" class="send-btn" (click)="sendRequest()">Envoyer</button>

      <!-- R√©sultat -->
      <h3 class="mt-4">R√©ponse :</h3>
      <pre class="response-box" [innerHTML]="formatJson(response)"></pre>
    </div>

    <!-- RIGHT -->
    <div class="col-md-2 mb-4 right">
      <h3>Historique :</h3>
      <mat-list>
        <mat-list-item *ngFor="let item of history">
          <strong>{{ item.method }}</strong> ‚Äì {{ item.url }}
          <span class="timestamp">{{ item.timestamp | date:'short' }}</span>
        </mat-list-item>
      </mat-list>
    </div>
  </div>

  <!-- Loader -->
  <div class="loader-overlay" *ngIf="isLoading">
    <div class="loader"></div>
  </div>

</div>
